<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="TipInstability() calculates the instability of each leaf in a tree.
Unstable leaves are likely to display roguish behaviour."><title>Tip instability — TipInstability • Rogue</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Tip instability — TipInstability"><meta property="og:description" content="TipInstability() calculates the instability of each leaf in a tree.
Unstable leaves are likely to display roguish behaviour."><meta name="robots" content="noindex"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">Rogue</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">2.0.0.9003</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-2">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ms609/Rogue/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Tip instability</h1>
      <small class="dont-index">Source: <a href="https://github.com/ms609/Rogue/blob/HEAD/R/stability.R" class="external-link"><code>R/stability.R</code></a></small>
      <div class="d-none name"><code>TipInstability.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>TipInstability()</code> calculates the instability of each leaf in a tree.
Unstable leaves are likely to display roguish behaviour.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">TipInstability</span><span class="op">(</span>
  <span class="va">trees</span>,
  log <span class="op">=</span> <span class="cn">TRUE</span>,
  average <span class="op">=</span> <span class="st">"mean"</span>,
  deviation <span class="op">=</span> <span class="st">"sd"</span>,
  checkTips <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span>

<span class="fu">ColByStability</span><span class="op">(</span><span class="va">trees</span>, log <span class="op">=</span> <span class="cn">TRUE</span>, average <span class="op">=</span> <span class="st">"mean"</span>, deviation <span class="op">=</span> <span class="st">"sd"</span><span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>trees</dt>
<dd><p>List of trees to analyse.</p></dd>
<dt>log</dt>
<dd><p>Logical specifying whether to log-transform distances when
calculating leaf stability.</p></dd>
<dt>average</dt>
<dd><p>Character specifying whether to use <code>'mean'</code> or <code>'median'</code>
tip distances to calculate leaf stability.</p></dd>
<dt>deviation</dt>
<dd><p>Character specifying whether to use <code>'sd'</code> or <code>'mad'</code> to
calculate leaf stability.</p></dd>
<dt>checkTips</dt>
<dd><p>Logical specifying whether to check that tips are numbered
consistently.</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Smith (2022)
 defines the <em>instability</em> of a pair
of leaves as the median absolute divergence in the graph geodesic
(the number of edges in the shortest path between the leaves) across all
trees, normalized against the mean graph geodesic.
The instability of a single leaf is the mean instability of all pairs that
include that leaf; higher values characterise leaves whose position is more
variable between trees.</p>
<p>Other concepts of leaf instability include</p><ul><li><p>The 'taxonomic instability index', as implemented in Mesquite:
described by Thomson and Shaffer (2010)
 as
\(\sum\limits_{(x, y), j \neq i}{\frac{|D~ijx~ - D~ijy~|}{(D~ijx~ - D~ijy~)^2}}\),
where \(D~ijx~\) is the patristic distance (i.e. length of edges)
between leaves \(i\) and \(j\) in tree \(x\).</p></li>
<li><p>the average stability of triplets (i.e. quartets including the root) that
include the leaf (Thorley and Wilkinson 1999)
, implemented in "Phyutility"
(Smith and Dunn 2008)
; and related to 'positional congruence'
mesures (Estabrook 1992; Pol and Escapa 2009)
.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Estabrook GF (1992).
“Evaluating undirected positional congruence of individual taxa between two estimates of the phylogenetic tree for a group of taxa.”
<em>Systematic Biology</em>, <b>41</b>(2), 172--177.
doi: <a href="https://doi.org/10.1093/sysbio/41.2.172" class="external-link">10.1093/sysbio/41.2.172</a>
.<br><br> Pol D, Escapa IH (2009).
“Unstable taxa in cladistic analysis: identification and the assessment of relevant characters.”
<em>Cladistics</em>, <b>25</b>(5), 515--527.
doi: <a href="https://doi.org/10.1111/j.1096-0031.2009.00258.x" class="external-link">10.1111/j.1096-0031.2009.00258.x</a>
.<br><br> Smith MR (2022).
“Using information theory to detect rogue taxa and improve consensus trees.”
<em>Systematic Biology</em>, syab099.
doi: <a href="https://doi.org/10.1093/sysbio/syab099" class="external-link">10.1093/sysbio/syab099</a>
.<br><br> Smith SA, Dunn CW (2008).
“Phyutility: a phyloinformatics tool for trees, alignments and molecular data.”
<em>Bioinformatics</em>, <b>24</b>(5), 715--716.
doi: <a href="https://doi.org/10.1093/bioinformatics/btm619" class="external-link">10.1093/bioinformatics/btm619</a>
.<br><br> Thomson RC, Shaffer HB (2010).
“Sparse supermatrices for phylogenetic inference: taxonomy, alignment, rogue taxa, and the phylogeny of living turtles.”
<em>Systematic Biology</em>, <b>59</b>(1), 42--58.
doi: <a href="https://doi.org/10.1093/sysbio/syp075" class="external-link">10.1093/sysbio/syp075</a>
.<br><br> Thorley JL, Wilkinson M (1999).
“Testing the phylogenetic stability of early tetrapods.”
<em>Journal of Theoretical Biology</em>, <b>200</b>(3), 343--344.
doi: <a href="https://doi.org/10.1006/jtbi.1999.0999" class="external-link">10.1006/jtbi.1999.0999</a>
.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other tip instability functions: 
<code><a href="TipVolatility.html">TipVolatility</a>()</code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p><a href="https://smithlabdurham.github.io/" class="external-link">Martin R. Smith</a>
(<a href="mailto:martin.smith@durham.ac.uk">martin.smith@durham.ac.uk</a>)</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://ms609.github.io/TreeTools/" class="external-link">"TreeTools"</a></span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"><span class="va">trees</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ms609.github.io/TreeTools/reference/AddTip.html" class="external-link">AddTipEverywhere</a></span><span class="op">(</span><span class="fu"><a href="https://ms609.github.io/TreeTools/reference/GenerateTree.html" class="external-link">BalancedTree</a></span><span class="op">(</span><span class="fl">8</span><span class="op">)</span>, <span class="st">'Rogue'</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/consensus.html" class="external-link">consensus</a></span><span class="op">(</span><span class="va">trees</span><span class="op">)</span>, tip.col <span class="op">=</span> <span class="fu">ColByStability</span><span class="op">(</span><span class="va">trees</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-plt img"><img src="TipInstability-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="va">instab</span> <span class="op">&lt;-</span> <span class="fu">TipInstability</span><span class="op">(</span><span class="va">trees</span>, log <span class="op">=</span> <span class="cn">FALSE</span>, ave <span class="op">=</span> <span class="st">'mean'</span>, dev <span class="op">=</span> <span class="st">'mad'</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://ms609.github.io/TreeTools/reference/ConsensusWithout.html" class="external-link">ConsensusWithout</a></span><span class="op">(</span><span class="va">trees</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">instab</span><span class="op">[</span><span class="va">instab</span> <span class="op">&gt;</span> <span class="fl">0.2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-plt img"><img src="TipInstability-2.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by <a href="https://smithlabdurham.github.io/" class="external-link">Martin R. Smith</a>, Andre J. Aberer.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

    </footer></div>

  

  

  </body></html>

