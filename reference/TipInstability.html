<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Tip instability — TipInstability • Rogue</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Tip instability — TipInstability"><meta property="og:description" content="TipInstability() calculates the instability of each leaf in a tree.
Unstable leaves are likely to display roguish behaviour."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Rogue</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.1.7</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Bayesian.html">Detecting rogue taxa in Bayesian posterior tree sets</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/ms609/Rogue/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Tip instability</h1>
    <small class="dont-index">Source: <a href="https://github.com/ms609/Rogue/blob/main/R/stability.R" class="external-link"><code>R/stability.R</code></a></small>
    <div class="hidden name"><code>TipInstability.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>TipInstability()</code> calculates the instability of each leaf in a tree.
Unstable leaves are likely to display roguish behaviour.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">TipInstability</span><span class="op">(</span></span>
<span>  <span class="va">trees</span>,</span>
<span>  log <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  average <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>  deviation <span class="op">=</span> <span class="st">"sd"</span>,</span>
<span>  checkTips <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ColByStability</span><span class="op">(</span></span>
<span>  <span class="va">trees</span>,</span>
<span>  log <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  average <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>  deviation <span class="op">=</span> <span class="st">"sd"</span>,</span>
<span>  pal <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">hcl.colors</a></span><span class="op">(</span><span class="fl">131</span>, <span class="st">"inferno"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">101</span><span class="op">]</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-trees">trees<a class="anchor" aria-label="anchor" href="#arg-trees"></a></dt>
<dd><p>List of trees to analyse.</p></dd>


<dt id="arg-log">log<a class="anchor" aria-label="anchor" href="#arg-log"></a></dt>
<dd><p>Logical specifying whether to log-transform distances when
calculating leaf stability.</p></dd>


<dt id="arg-average">average<a class="anchor" aria-label="anchor" href="#arg-average"></a></dt>
<dd><p>Character specifying whether to use <code>"mean"</code> or <code>"median"</code>
tip distances to calculate leaf stability.</p></dd>


<dt id="arg-deviation">deviation<a class="anchor" aria-label="anchor" href="#arg-deviation"></a></dt>
<dd><p>Character specifying whether to use <code>"sd"</code> or <code>"mad"</code> to
calculate leaf stability.</p></dd>


<dt id="arg-checktips">checkTips<a class="anchor" aria-label="anchor" href="#arg-checktips"></a></dt>
<dd><p>Logical specifying whether to check that tips are numbered
consistently.</p></dd>


<dt id="arg-parallel">parallel<a class="anchor" aria-label="anchor" href="#arg-parallel"></a></dt>
<dd><p>Logical specifying whether parallel execution should take
place in C++.</p></dd>


<dt id="arg-pal">pal<a class="anchor" aria-label="anchor" href="#arg-pal"></a></dt>
<dd><p>A vector listing a sequence of colours to be used for plotting.
The earliest entries will be assigned to the most stable tips.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p><code>ColByStability()</code> returns a named character vector that assigns a
colour to each leaf in <code>trees</code> according to their stability.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Smith (2022)
 defines the <em>instability</em> of a pair
of leaves as the median absolute divergence in the graph geodesic
(the number of edges in the shortest path between the leaves) across all
trees, normalized against the mean graph geodesic.
The instability of a single leaf is the mean instability of all pairs that
include that leaf; higher values characterise leaves whose position is more
variable between trees.</p>
<p>Other concepts of leaf instability include</p><ul><li><p>The "taxonomic instability index", as implemented in Mesquite:
described by Thomson and Shaffer (2010)
 as
\(\sum\limits_{(x, y), j \neq i}{\frac{|D~ijx~ - D~ijy~|}{(D~ijx~ - D~ijy~)^2}}\),
where \(D~ijx~\) is the patristic distance (i.e. length of edges)
between leaves \(i\) and \(j\) in tree \(x\).</p></li>
<li><p>the average stability of triplets (i.e. quartets including the root) that
include the leaf (Thorley and Wilkinson 1999)
, implemented in "Phyutility"
(Smith and Dunn 2008)
; and related to "positional congruence"
measures (Estabrook 1992; Pol and Escapa 2009)
.</p></li>
</ul></div>
    <div id="references">
    <h2>References</h2>
    <p>Estabrook GF (1992).
“Evaluating undirected positional congruence of individual taxa between two estimates of the phylogenetic tree for a group of taxa.”
<em>Systematic Biology</em>, <b>41</b>(2), 172–177.
<a href="https://doi.org/10.1093/sysbio/41.2.172" class="external-link">doi:10.1093/sysbio/41.2.172</a>
.<br><br> Pol D, Escapa IH (2009).
“Unstable taxa in cladistic analysis: identification and the assessment of relevant characters.”
<em>Cladistics</em>, <b>25</b>(5), 515–527.
<a href="https://doi.org/10.1111/j.1096-0031.2009.00258.x" class="external-link">doi:10.1111/j.1096-0031.2009.00258.x</a>
.<br><br> Smith MR (2022).
“Using information theory to detect rogue taxa and improve consensus trees.”
<em>Systematic Biology</em>, <b>71</b>(5), 986–1008.
<a href="https://doi.org/10.1093/sysbio/syab099" class="external-link">doi:10.1093/sysbio/syab099</a>
.<br><br> Smith SA, Dunn CW (2008).
“Phyutility: a phyloinformatics tool for trees, alignments and molecular data.”
<em>Bioinformatics</em>, <b>24</b>(5), 715–716.
<a href="https://doi.org/10.1093/bioinformatics/btm619" class="external-link">doi:10.1093/bioinformatics/btm619</a>
.<br><br> Thomson RC, Shaffer HB (2010).
“Sparse supermatrices for phylogenetic inference: taxonomy, alignment, rogue taxa, and the phylogeny of living turtles.”
<em>Systematic Biology</em>, <b>59</b>(1), 42–58.
<a href="https://doi.org/10.1093/sysbio/syp075" class="external-link">doi:10.1093/sysbio/syp075</a>
.<br><br> Thorley JL, Wilkinson M (1999).
“Testing the phylogenetic stability of early tetrapods.”
<em>Journal of Theoretical Biology</em>, <b>200</b>(3), 343–344.
<a href="https://doi.org/10.1006/jtbi.1999.0999" class="external-link">doi:10.1006/jtbi.1999.0999</a>
.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>Other tip instability functions:
<code><a href="TipVolatility.html">TipVolatility()</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p><a href="https://smithlabdurham.github.io/" class="external-link">Martin R. Smith</a>
(<a href="mailto:martin.smith@durham.ac.uk">martin.smith@durham.ac.uk</a>)</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://ms609.github.io/TreeTools/" class="external-link">"TreeTools"</a></span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate some trees with a rogue taxon</span></span></span>
<span class="r-in"><span><span class="va">trees</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ms609.github.io/TreeTools/reference/AddTip.html" class="external-link">AddTipEverywhere</a></span><span class="op">(</span><span class="fu"><a href="https://ms609.github.io/TreeTools/reference/GenerateTree.html" class="external-link">BalancedTree</a></span><span class="op">(</span><span class="fl">8</span><span class="op">)</span>, <span class="st">"Rogue"</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Display the strict consensus</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/consensus.html" class="external-link">consensus</a></span><span class="op">(</span><span class="va">trees</span><span class="op">)</span>, tip.col <span class="op">=</span> <span class="fu">ColByStability</span><span class="op">(</span><span class="va">trees</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Add a legend for the colour scale used</span></span></span>
<span class="r-in"><span><span class="fu">PlotTools</span><span class="fu">::</span><span class="fu"><a href="https://ms609.github.io/PlotTools/reference/SpectrumLegend.html" class="external-link">SpectrumLegend</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="st">"bottomleft"</span>, bty <span class="op">=</span> <span class="st">"n"</span>, <span class="co"># No box</span></span></span>
<span class="r-in"><span>  legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Unstable"</span>, <span class="st">""</span>, <span class="st">"Stable"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  palette <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">hcl.colors</a></span><span class="op">(</span><span class="fl">131</span>, <span class="st">"inferno"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">101</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="TipInstability-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate leaf stability</span></span></span>
<span class="r-in"><span><span class="va">instab</span> <span class="op">&lt;-</span> <span class="fu">TipInstability</span><span class="op">(</span><span class="va">trees</span>, log <span class="op">=</span> <span class="cn">FALSE</span>, ave <span class="op">=</span> <span class="st">"mean"</span>, dev <span class="op">=</span> <span class="st">"mad"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot a consensus that omits the least stable leaves</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://ms609.github.io/TreeTools/reference/ConsensusWithout.html" class="external-link">ConsensusWithout</a></span><span class="op">(</span><span class="va">trees</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">instab</span><span class="op">[</span><span class="va">instab</span> <span class="op">&gt;</span> <span class="fl">0.2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="TipInstability-2.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by <a href="https://smithlabdurham.github.io/" class="external-link">Martin R. Smith</a>, Andre J. Aberer.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer></div>






  </body></html>

